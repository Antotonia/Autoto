select ttt."国标分类",ttt."资产大类",ttt."单位性质",ttt. "年度",ttt."所属区县",ttt."所属系统",ttt."单位名称",ttt."单位信用码",ttt."分类资产价值"  from (
select sortgb.stdname as "国标分类",
       case
         when sortgb.stdname = '无形资产' then
          '无形资产'
         else
          '固定资产'
       end as "资产大类",
       case
         when acc.stdcode = '01' then
          '行政单位'
         when acc.stdcode = '02' then
          '事业单位'
         else
          '民间非营利组织'
       end as "单位性质",
       '2015' as "年度",
       admd.stdname as "所属区县",
       '资产' as "所属系统",
       md.stdname as "单位名称",
md.shehxydm as "单位信用码",
       sum(card.jiaz) as "分类资产价值"
  from gams_assetcard card
  join (select max(card2.yewxlh) as y, card2.objectid as g
          from gams_assetcard card2
         where card2.AUDITSTATE = 2
           and to_char(card2.jizrq, 'yyyymmdd') <= '20151231'
         group by card2.objectid) f
    on card.yewxlh = f.y
   and card.objectid = f.g
  right join md_org md
    on md.recid = card.orgunit
  left join gams_jc_assetsort_gb sortgb
    on sortgb.recid = card.sortgbid
  left join GAMS_JC_UNITRUNACCSYSTEM acc
    on acc.recid = md.danwzxkjzdid
  left join GAMS_JC_ADMDIVISIONS admd
    on admd.recid = md.xingzqhid
 where card.auditstate = 2 and card.cardstate <'09' and md.stdname is not null and md.shehxydm is not null
 group by md.stdname, sortgb.stdname, acc.stdcode, admd.stdname,md.shehxydm
 union all
 select sortgb.stdname as "国标分类",
       case
         when sortgb.stdname = '无形资产' then
          '无形资产'
         else
          '固定资产'
       end as "资产大类",
       case
         when acc.stdcode = '01' then
          '行政单位'
         when acc.stdcode = '02' then
          '事业单位'
         else
          '民间非营利组织'
       end as "单位性质",
       '2016' as "年度",
       admd.stdname as "所属区县",
       '资产' as "所属系统",
       md.stdname as "单位名称",
md.shehxydm as "单位信用码",
       sum(card.jiaz) as "分类资产价值"
  from gams_assetcard card
  join (select max(card2.yewxlh) as y, card2.objectid as g
          from gams_assetcard card2
         where card2.AUDITSTATE = 2
           and to_char(card2.jizrq, 'yyyymmdd') <= '20161231'
         group by card2.objectid) f
    on card.yewxlh = f.y
   and card.objectid = f.g
  right join md_org md
    on md.recid = card.orgunit
  left join gams_jc_assetsort_gb sortgb
    on sortgb.recid = card.sortgbid
  left join GAMS_JC_UNITRUNACCSYSTEM acc
    on acc.recid = md.danwzxkjzdid
  left join GAMS_JC_ADMDIVISIONS admd
    on admd.recid = md.xingzqhid
 where card.auditstate = 2  and card.cardstate <'09' and md.stdname is not null  and md.shehxydm is not null
 group by md.stdname, sortgb.stdname, acc.stdcode, admd.stdname,md.shehxydm
  union all
 select sortgb.stdname as "国标分类",
       case
         when sortgb.stdname = '无形资产' then
          '无形资产'
         else
          '固定资产'
       end as "资产大类",
       case
         when acc.stdcode = '01' then
          '行政单位'
         when acc.stdcode = '02' then
          '事业单位'
         else
          '民间非营利组织'
       end as "单位性质",
       '2017' as "年度",
       admd.stdname as "所属区县",
       '资产' as "所属系统",
       md.stdname as "单位名称",
md.shehxydm as "单位信用码",
       sum(card.jiaz) as "分类资产价值"
  from gams_assetcard card
  join (select max(card2.yewxlh) as y, card2.objectid as g
          from gams_assetcard card2
         where card2.AUDITSTATE = 2
           and to_char(card2.jizrq, 'yyyymmdd') <= '20171231'
         group by card2.objectid) f
    on card.yewxlh = f.y
   and card.objectid = f.g
  right join md_org md
    on md.recid = card.orgunit
  left join gams_jc_assetsort_gb sortgb
    on sortgb.recid = card.sortgbid
  left join GAMS_JC_UNITRUNACCSYSTEM acc
    on acc.recid = md.danwzxkjzdid
  left join GAMS_JC_ADMDIVISIONS admd
    on admd.recid = md.xingzqhid
 where card.auditstate = 2 and card.cardstate <'09'  and md.stdname is not null  and md.shehxydm is not null
 group by md.stdname, sortgb.stdname, acc.stdcode, admd.stdname,md.shehxydm
  union all
 select sortgb.stdname as "国标分类",
       case
         when sortgb.stdname = '无形资产' then
          '无形资产'
         else
          '固定资产'
       end as "资产大类",
       case
         when acc.stdcode = '01' then
          '行政单位'
         when acc.stdcode = '02' then
          '事业单位'
         else
          '民间非营利组织'
       end as "单位性质",
       '2018' as "年度",
       admd.stdname as "所属区县",
       '资产' as "所属系统",
       md.stdname as "单位名称",
md.shehxydm as "单位信用码",
       sum(card.jiaz) as "分类资产价值"
  from gams_assetcard card
  join (select max(card2.yewxlh) as y, card2.objectid as g
          from gams_assetcard card2
         where card2.AUDITSTATE = 2
           and to_char(card2.jizrq, 'yyyymmdd') <= '20181231'
         group by card2.objectid) f
    on card.yewxlh = f.y
   and card.objectid = f.g
  right join md_org md
    on md.recid = card.orgunit
  left join gams_jc_assetsort_gb sortgb
    on sortgb.recid = card.sortgbid
  left join GAMS_JC_UNITRUNACCSYSTEM acc
    on acc.recid = md.danwzxkjzdid
  left join GAMS_JC_ADMDIVISIONS admd
    on admd.recid = md.xingzqhid
 where card.auditstate = 2 and card.cardstate <'09'  and md.stdname is not null  and md.shehxydm is not null
 group by md.stdname, sortgb.stdname, acc.stdcode, admd.stdname,md.shehxydm
  union all
 select sortgb.stdname as "国标分类",
       case
         when sortgb.stdname = '无形资产' then
          '无形资产'
         else
          '固定资产'
       end as "资产大类",
       case
         when acc.stdcode = '01' then
          '行政单位'
         when acc.stdcode = '02' then
          '事业单位'
         else
          '民间非营利组织'
       end as "单位性质",
       '2019' as "年度",
       admd.stdname as "所属区县",
       '资产' as "所属系统",
       md.stdname as "单位名称",
md.shehxydm as "单位信用码",
       sum(card.jiaz) as "分类资产价值"
  from gams_assetcard card
  join (select max(card2.yewxlh) as y, card2.objectid as g
          from gams_assetcard card2
         where card2.AUDITSTATE = 2
           and to_char(card2.jizrq, 'yyyymmdd') <= '20191231'
         group by card2.objectid) f
    on card.yewxlh = f.y
   and card.objectid = f.g
  right join md_org md
    on md.recid = card.orgunit
  left join gams_jc_assetsort_gb sortgb
    on sortgb.recid = card.sortgbid
  left join GAMS_JC_UNITRUNACCSYSTEM acc
    on acc.recid = md.danwzxkjzdid
  left join GAMS_JC_ADMDIVISIONS admd
    on admd.recid = md.xingzqhid
 where card.auditstate = 2 and card.cardstate <'09'  and md.stdname is not null  and md.shehxydm is not null
 group by md.stdname, sortgb.stdname, acc.stdcode, admd.stdname,md.shehxydm
 union all
 select sortgb.stdname as "国标分类",
       case
         when sortgb.stdname = '无形资产' then
          '无形资产'
         else
          '固定资产'
       end as "资产大类",
       case
         when acc.stdcode = '01' then
          '行政单位'
         when acc.stdcode = '02' then
          '事业单位'
         else
          '民间非营利组织'
       end as "单位性质",
       '2020' as "年度",
       admd.stdname as "所属区县",
       '资产' as "所属系统",
       md.stdname as "单位名称",
md.shehxydm as "单位信用码",
       sum(card.jiaz) as "分类资产价值"
  from gams_assetcard card
  join (select max(card2.yewxlh) as y, card2.objectid as g
          from gams_assetcard card2
         where card2.AUDITSTATE = 2
           and to_char(card2.jizrq, 'yyyymmdd') <= '20201231'
         group by card2.objectid) f
    on card.yewxlh = f.y
   and card.objectid = f.g
  right join md_org md
    on md.recid = card.orgunit
  left join gams_jc_assetsort_gb sortgb
    on sortgb.recid = card.sortgbid
  left join GAMS_JC_UNITRUNACCSYSTEM acc
    on acc.recid = md.danwzxkjzdid
  left join GAMS_JC_ADMDIVISIONS admd
    on admd.recid = md.xingzqhid
 where card.auditstate = 2 and card.cardstate <'09'  and md.stdname is not null  and md.shehxydm is not null
 group by md.stdname, sortgb.stdname, acc.stdcode, admd.stdname,md.shehxydm
 )
 as ttt where ttt."单位信用码" <>''